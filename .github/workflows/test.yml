name: Test and install package

on: pull_request

jobs:
  build:
    runs-on: ubuntu-latest
    container: rocker/r-ver:4.3.2
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        
      - name: Install system dependencies
        run: |
          apt-get update
          apt-get install -y --no-install-recommends \
            pandoc \
            curl \
            libxml2-dev \
            libssl-dev \
            libcurl4-openssl-dev
          apt-get clean
          rm -rf /var/lib/apt/lists/
          
      - name: Install Package Dependencies
        run: |
          Rscript -e "install.packages('remotes', repos = 'https://cran.rstudio.com/')"
          Rscript -e "remotes::install_deps(dependencies = TRUE, repos = 'https://cran.rstudio.com/')"
          
      - name: Test Package
        run: |
          Rscript -e "testthat::test_dir(path = 'tests/testthat')"
